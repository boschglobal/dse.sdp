# Open Loop Simulation with Lua Models Example

## Introduction

Use a simple CSV file and models written in Lua to operate an Open Loop simulation which represents a Linear Equation.


### Example Layout

```text
examples
└── openloop_lua
    └── data
        └── input.csv                 <-- Input data (used by input/csv model).
        └── input_sg.yaml             <-- Signal Group definition for input data.
        └── linear_sg.yaml            <-- Signal Group definition for linear model.
    └── Makefile                      <-- Automation targets: build, simer.
    └── csv.lua                       <-- Lua model which reads samples from a CVS file.
    └── linear.lua                    <-- Lua model implementing a linear equation.
    └── openloop.dse                  <-- Simulation definition in DSE Script.
    └── README.md                     <-- Usage instructions for the example.
```


## Usage

Start a Codespace, then type the following commands in the terminal window.

__Cloudspace Terminal__
```bash
$ cd examples/openloop_lua

# Build and run the example simulation.
$ make build
$ make simer
...
3) Lua MCL: loading model: model/linear/linear.lua
3) Linear model_create()
3) Initial values: input=0.000000 factor=0.000000 offset=0.000000 output=0.000000
3) Run the Simulation ...
3)     Pull Endpoint: dse.model.2
3) Step@0.0000: input=0.000000 factor=0.000000 offset=0.000000 output=0.000000
3) Step@0.0005: input=1.000000 factor=2.000000 offset=3.000000 output=5.000000
3) Step@0.0010: input=-1.100000 factor=2.100000 offset=3.100000 output=0.790000
3) Step@0.0015: input=1.200000 factor=-2.200000 offset=3.200000 output=0.560000
3) Step@0.0020: input=1.300000 factor=2.300000 offset=-3.300000 output=-0.310000
3) Step@0.0025: input=1.300000 factor=2.300000 offset=-3.300000 output=-0.310000
...
```

### Simulation Layout (generated by Taskfile)

```text
examples/openloop_lua/out
└── sim
    └── data
        └── simulation.yaml           <-- Simulation definition, contains stacks.
    └── model/input
        └── data
            └── input.csv             <-- Scenario definition (copied from data/input.csv).
            └── signalgroup.yaml      <-- SignalGroup (copied from data/input_sg.yaml).
        └── csv.lua                   <-- Model implementation (copied from csv.lua).
    └── model/linear
        └── data
            └── signalgroup.yaml      <-- SignalGroup (copied from data/linear_sg.yaml).
        └── linear.lua                <-- Model implementation (copied from linear.lua).
```